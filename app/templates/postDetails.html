{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}


{% block content %}

{%block css%}
<link rel="stylesheet" href="{% static 'css/community.css' %}">
{%endblock%}

{% include 'navbar.html' %}

    <section class="content-wrapper">
        <button>
            <span><a href="javascript:history.back()" class="box">Back</a></span>
        </button>   


        <div class="post-details-wrapper">


            <div class="card">
                <span class="title">{{ post.title }}</span>
                <div>
                    <div></div>
                    <div class="reply-container">
                        <div class="user">
                            <div></div>
                            <div class="user-info">
                                <span>{{post.author.username}}</span>
                                <p>{{post.created_at}}</p>
                            </div>
                        </div>
                        <p class="reply-content">
                        {{post.content}}
                        </p>
                    </div>
                </div>


<div class='comment-section'>
    <div class='comments-title-section'>
        <h3 class="comments-title">Replies</h3>
    </div>
        {% if post.comments.all %}
            <div class="comments-list">
                {% for reply in post.comments.all %}
                    <div class="comment-item">
                        <div class="user">
                            <div class="user-info">
                                <span>{{ reply.author.username }} - <span>{{ reply.created_at }}</span></span>
                            </div>
                        </div>
                        <p class="reply-content">{{ reply.content }}</p>
                        {%if user == reply.post.author or user == reply.author %}
                            <form action="{% url 'delete-comment' reply.id %}" method="POST" class="delete-btn">
                                {% csrf_token %}
                                <button type="submit" class="delete-button"
                                        onclick="return confirm('Are you sure you want to delete this post?');">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2 w-4 h-4"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line></svg>
                                </button>
                            </form>
                    {% endif %}
                    </div>
                    
                {% endfor %}
            </div>
        {% else %}
            <p class="no-replies">No replies yet. Be the first to reply!</p>
        {% endif %}
</div>


                <div class="text-box">
                    <form method="POST" action="{% url 'post-details' post.id %}">
                        {% csrf_token %}
                        {% render_field form.content class='box-container' placeholder="Post your reply" %}
                        <div class="formatting">
                            <button type="submit" class="send" title="Send">
                                <svg fill="none" viewBox="0 0 24 24" height="18" width="18" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" stroke="#ffffff" d="M12 5L12 20"></path>
                                <path stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" stroke="#ffffff" d="M7 9L11.2929 4.70711C11.6262 4.37377 11.7929 4.20711 12 4.20711C12.2071 4.20711 12.3738 4.37377 12.7071 4.70711L17 9"></path>
                                </svg>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

</div>





    </section>


{% endblock content %}