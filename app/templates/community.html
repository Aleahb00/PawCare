{% extends 'base.html' %}


{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h1>Community Posts</h1>

            
            <form method="POST" action="{% url 'create-post'%}">
        {% csrf_token %}
        {% for field in form %}
            {{field.label_tag}}
            {{field}}
        {% endfor %}
        <button type="submit" class="button">Post</button>
    </form>

                <a href="javascript:history.back()">Go Back</a>

            {% if user.is_authenticated %}
            <a href="{% url 'create-post' %}" class="btn btn-primary mb-4">Create Post</a>
            {% endif %} 
            {% if posts %}
                {% for post in posts %}
                <div>
                    <div style="border:1px solid black; margin-bottom:20vh;">
                        <h5 class="card-title">{{ post.title }}</h5>
                        <p class="card-text text-muted">By {{ post.author }} on {{ post.created_at }}</p>
                        <p class="card-text">{{ post.content|truncatewords:50 }}</p>
                        <a href="{% url 'post-details' post.id %}">More</a>
                        {%if user == post.author%}
                        <a href='{% url 'edit-post' post.id%}'> Edit </a>
                        <a href='{% url 'delete-post' post.id%}'> Delete </a>
                        {%endif%}
                        {% comment %} <a href='{}' {% endcomment %}
                        {% comment %} <a href="{% url 'post_detail' post.id %}">View Post</a> {% endcomment %}
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p class="text-muted">No posts yet. Be the first to share!</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}